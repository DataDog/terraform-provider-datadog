---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "datadog_csm_threats_agent_rule Resource - terraform-provider-datadog"
subcategory: ""
description: |-
  Provides a Datadog Workload Protection (CSM Threats) Agent Rule API resource.
---

# datadog_csm_threats_agent_rule (Resource)

Provides a Datadog Workload Protection (CSM Threats) Agent Rule API resource.

## Example Usage

```terraform
resource "datadog_csm_threats_agent_rule" "my_agent_rule" {
  name         = "my_agent_rule"
  enabled      = true
  description  = "This is a rule"
  expression   = "open.file.name == \"etc/shadow/password\""
  policy_id    = "jm4-lwh-8cs"
  product_tags = ["compliance_framework:PCI-DSS"]
  actions {
    set {
      name   = "updated_security_actions"
      field  = "exec.file.path"
      append = false
      scope  = "process"
    }
    hash {}
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `expression` (String) The SECL expression of the Agent rule
- `name` (String) The name of the Agent rule.

### Optional

- `actions` (Block List) The list of actions the rule can perform (see [below for nested schema](#nestedblock--actions))
- `description` (String) A description for the Agent rule.
- `enabled` (Boolean) Indicates whether the Agent rule is enabled. Must not be used without policy_id.
- `policy_id` (String) The ID of the agent policy in which the rule is saved
- `product_tags` (Set of String) The list of product tags associated with the rule

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--actions"></a>
### Nested Schema for `actions`

Optional:

- `hash` (Block, Optional) Hash action configuration (see [below for nested schema](#nestedblock--actions--hash))
- `set` (Block, Optional) Set action configuration (see [below for nested schema](#nestedblock--actions--set))

<a id="nestedblock--actions--hash"></a>
### Nested Schema for `actions.hash`

Optional:

- `field` (String) The field to hash


<a id="nestedblock--actions--set"></a>
### Nested Schema for `actions.set`

Optional:

- `append` (Boolean) Whether to append to the set
- `default_value` (String) The default value to set
- `expression` (String) The expression to use for the set action
- `field` (String) The field to get the value from
- `inherited` (Boolean) Whether the set action is inherited
- `name` (String) The name of the set action
- `scope` (String) The scope of the set action (process, container, cgroup, or empty)
- `size` (Number) The maximum size of the set
- `ttl` (Number) The time to live for the set in nanoseconds
- `value` (String) The value to set

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# CSM Agent Rules can be imported using ID. For example:
terraform import datadog_csm_threats_agent_rule.my_agent_rule m0o-hto-lkb
#Â CSM Agent Rules can also be imported using the policy ID and the rule ID. For example:
terraform import datadog_csm_threats_agent_rule.my_agent_rule jm4-lwh-8cs:m0o-hto-lkb
```
