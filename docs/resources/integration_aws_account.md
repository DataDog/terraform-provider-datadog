---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "datadog_integration_aws_account Resource - terraform-provider-datadog"
subcategory: ""
description: |-
  Provides a Datadog-Amazon Web Services integration resource. This can be used to create and manage Datadog-Amazon Web Services integration.
---

# datadog_integration_aws_account (Resource)

Provides a Datadog-Amazon Web Services integration resource. This can be used to create and manage Datadog-Amazon Web Services integration.

## Example Usage

```terraform
# Create new integration_aws_account resource

resource "datadog_integration_aws_account" "foo" {
  account_tags   = ["env:prod"]
  aws_account_id = "123456789012"
  aws_partition  = "aws"
  aws_regions {
    include_all = true
  }

  auth_config {
    aws_auth_config_role {
      role_name = "DatadogIntegrationRole"
    }
  }
  logs_config {
    lambda_forwarder {
      lambdas = ["arn:aws:lambda:us-east-1:123456789012:function:my-lambda"]
      sources = ["s3"]
      log_source_config {
        tag_filters {
          source = "s3"
          tags   = ["env:prod", "team:backend"]
        }
      }
    }
  }
  metrics_config {
    automute_enabled          = true
    collect_cloudwatch_alarms = true
    collect_custom_metrics    = true
    enabled                   = true
    namespace_filters {
      exclude_only = ["AWS/SQS", "AWS/ElasticMapReduce", "AWS/Usage"]
    }
    tag_filters {
      namespace = "AWS/EC2"
      tags      = ["datadog:true"]
    }
  }
  resources_config {
    cloud_security_posture_management_collection = true
    extended_collection                          = true
  }
  traces_config {
    xray_services {
      include_all = true
    }
  }
}

# Create new integration_aws_account resource with all Datadog-provided defaults configured
resource "datadog_integration_aws_account" "foo-defaults" {
  aws_account_id = "234567890123"
  aws_partition  = "aws"
  aws_regions {}

  auth_config {
    aws_auth_config_role {
      role_name = "DatadogIntegrationRole"
    }
  }
  logs_config {
    lambda_forwarder {}
  }
  metrics_config {
    namespace_filters {}
  }
  resources_config {}
  traces_config {
    xray_services {}
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `aws_account_id` (String) Your AWS Account ID without dashes. Invalid aws_account_id.
- `aws_partition` (String) AWS Account partition. Valid values are `aws`, `aws-cn`, `aws-us-gov`.

### Optional

- `account_tags` (List of String) Tags to apply to all metrics in the account.
- `auth_config` (Block, Optional) Configure how Datadog authenticates to your AWS Account. Either `aws_auth_config_keys` or `aws_auth_config_role` block is required within. (see [below for nested schema](#nestedblock--auth_config))
- `aws_regions` (Block, Optional) AWS Regions to collect data from. Defaults to `include_all` if block is empty. (see [below for nested schema](#nestedblock--aws_regions))
- `logs_config` (Block, Optional) Configure log autosubscription for your Datadog Forwarder Lambda functions. The `lambda_forwarder` block is required within, but may be empty to use defaults. (see [below for nested schema](#nestedblock--logs_config))
- `metrics_config` (Block, Optional) Configure metrics collection from AWS CloudWatch. The `namespace_filters` block is required within, but may be empty to use defaults. (see [below for nested schema](#nestedblock--metrics_config))
- `resources_config` (Block, Optional) AWS Resources Collection config. May be empty to use defaults. (see [below for nested schema](#nestedblock--resources_config))
- `traces_config` (Block, Optional) AWS Traces Collection config. The `xray_services` block is required within, but may be empty to use defaults. (see [below for nested schema](#nestedblock--traces_config))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--auth_config"></a>
### Nested Schema for `auth_config`

Optional:

- `aws_auth_config_keys` (Block, Optional) Datadog will use the provided AWS Access Key ID and Secret Access Key to authenticate to your account. (see [below for nested schema](#nestedblock--auth_config--aws_auth_config_keys))
- `aws_auth_config_role` (Block, Optional) (see [below for nested schema](#nestedblock--auth_config--aws_auth_config_role))

<a id="nestedblock--auth_config--aws_auth_config_keys"></a>
### Nested Schema for `auth_config.aws_auth_config_keys`

Optional:

- `access_key_id` (String) AWS Access Key ID. Invalid access_key_id.
- `secret_access_key` (String, Sensitive) AWS Secret Access Key. This value is write-only; changes made outside of Terraform will not be drift-detected. Secret_access_key must be non-empty and not contain whitespace.


<a id="nestedblock--auth_config--aws_auth_config_role"></a>
### Nested Schema for `auth_config.aws_auth_config_role`

Optional:

- `external_id` (String) AWS IAM External ID for associated role. If omitted, one will be generated.
- `role_name` (String) AWS IAM Role name.



<a id="nestedblock--aws_regions"></a>
### Nested Schema for `aws_regions`

Optional:

- `include_all` (Boolean) Include all regions. Defaults to `true`.
- `include_only` (List of String) Include only these regions.


<a id="nestedblock--logs_config"></a>
### Nested Schema for `logs_config`

Optional:

- `lambda_forwarder` (Block, Optional) (see [below for nested schema](#nestedblock--logs_config--lambda_forwarder))

<a id="nestedblock--logs_config--lambda_forwarder"></a>
### Nested Schema for `logs_config.lambda_forwarder`

Optional:

- `lambdas` (List of String) List of Datadog Lambda Log Forwarder ARNs in your AWS account. Defaults to `[]`.
- `log_source_config` (Block, Optional) Configure log source collection for your Datadog Forwarder Lambda functions. (see [below for nested schema](#nestedblock--logs_config--lambda_forwarder--log_source_config))
- `sources` (List of String) List of service IDs set to enable automatic log collection. Use [`datadog_integration_aws_available_logs_services` data source](https://registry.terraform.io/providers/DataDog/datadog/latest/docs/data-sources/integration_aws_available_logs_services) or [the AWS Logs Integration API](https://docs.datadoghq.com/api/latest/aws-logs-integration/?#get-list-of-aws-log-ready-services) to get allowed values. Defaults to `[]`.

<a id="nestedblock--logs_config--lambda_forwarder--log_source_config"></a>
### Nested Schema for `logs_config.lambda_forwarder.log_source_config`

Optional:

- `tag_filters` (Block List) AWS Logs Collection tag filters list. (see [below for nested schema](#nestedblock--logs_config--lambda_forwarder--log_source_config--tag_filters))

<a id="nestedblock--logs_config--lambda_forwarder--log_source_config--tag_filters"></a>
### Nested Schema for `logs_config.lambda_forwarder.log_source_config.tag_filters`

Required:

- `source` (String) The AWS service for which the tag filters defined in `tags` will be applied.
- `tags` (List of String) The AWS resource tags to filter on for the service specified by `source`.





<a id="nestedblock--metrics_config"></a>
### Nested Schema for `metrics_config`

Optional:

- `automute_enabled` (Boolean) Enable EC2 automute for AWS metrics Defaults to `true`.
- `collect_cloudwatch_alarms` (Boolean) Enable CloudWatch alarms collection Defaults to `false`.
- `collect_custom_metrics` (Boolean) Enable custom metrics collection Defaults to `false`.
- `enabled` (Boolean) Enable AWS metrics collection Defaults to `true`.
- `namespace_filters` (Block, Optional) AWS Metrics namespace filters. Defaults to a pre-set `exclude_only` list if block is empty. (see [below for nested schema](#nestedblock--metrics_config--namespace_filters))
- `tag_filters` (Block List) AWS Metrics Collection tag filters list. The array of custom AWS resource tags (in the form `key:value`) defines a filter that Datadog uses when collecting metrics from a specified service. Wildcards, such as `?` (match a single character) and `*` (match multiple characters), and exclusion using `!` before the tag are supported. For EC2, only hosts that match one of the defined tags will be imported into Datadog. The rest will be ignored. For example, `env:production,instance-type:c?.*,!region:us-east-1`. (see [below for nested schema](#nestedblock--metrics_config--tag_filters))

<a id="nestedblock--metrics_config--namespace_filters"></a>
### Nested Schema for `metrics_config.namespace_filters`

Optional:

- `exclude_only` (List of String) Exclude only these namespaces from metrics collection. Use [`datadog_integration_aws_available_namespaces` data source](https://registry.terraform.io/providers/DataDog/datadog/latest/docs/data-sources/integration_aws_available_namespaces) to get allowed values. Defaults to `["AWS/SQS", "AWS/ElasticMapReduce", "AWS/Usage"]`. `AWS/SQS`, `AWS/ElasticMapReduce`, and `AWS/Usage` are excluded by default to reduce your AWS CloudWatch costs from `GetMetricData` API calls.
- `include_only` (List of String) Include only these namespaces for metrics collection. Use [`datadog_integration_aws_available_namespaces` data source](https://registry.terraform.io/providers/DataDog/datadog/latest/docs/data-sources/integration_aws_available_namespaces) to get allowed values.


<a id="nestedblock--metrics_config--tag_filters"></a>
### Nested Schema for `metrics_config.tag_filters`

Required:

- `namespace` (String) The AWS service for which the tag filters defined in `tags` will be applied.

Optional:

- `tags` (List of String) The AWS resource tags to filter on for the service specified by `namespace`. Defaults to `[]`.



<a id="nestedblock--resources_config"></a>
### Nested Schema for `resources_config`

Optional:

- `cloud_security_posture_management_collection` (Boolean) Enable Cloud Security Management to scan AWS resources for vulnerabilities, misconfigurations, identity risks, and compliance violations. Requires `extended_collection` to be set to `true`. Defaults to `false`.
- `extended_collection` (Boolean) Whether Datadog collects additional attributes and configuration information about the resources in your AWS account. Required for `cloud_security_posture_management_collection`. Defaults to `true`.


<a id="nestedblock--traces_config"></a>
### Nested Schema for `traces_config`

Optional:

- `xray_services` (Block, Optional) AWS X-Ray services to collect traces from. Defaults to `include_only`. (see [below for nested schema](#nestedblock--traces_config--xray_services))

<a id="nestedblock--traces_config--xray_services"></a>
### Nested Schema for `traces_config.xray_services`

Optional:

- `include_all` (Boolean) Include all services.
- `include_only` (List of String) Include only these services. Defaults to `[]`.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# AWS Account Config ID can be retrieved by using the List all AWS integrations endpoint and querying by AWS Account ID:
# https://docs.datadoghq.com/api/latest/aws-integration/#list-all-aws-integrations


terraform import datadog_integration_aws_account.example "<datadog-aws-account-config-id>"
```
