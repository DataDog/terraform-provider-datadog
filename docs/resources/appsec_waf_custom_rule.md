---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "datadog_appsec_waf_custom_rule Resource - terraform-provider-datadog"
subcategory: ""
description: |-
  Provides a Datadog AppsecWafCustomRule resource. This can be used to create and manage Datadog appsec_waf_custom_rule.
---

# datadog_appsec_waf_custom_rule (Resource)

Provides a Datadog AppsecWafCustomRule resource. This can be used to create and manage Datadog appsec_waf_custom_rule.

## Example Usage

```terraform
# Create a new WAF custom rule to block a custom IoC
resource "datadog_appsec_waf_custom_rule" "ioc000" {
  name = "Block requests from a bad actor"

  blocking = true
  enabled  = true

  tags = {
    category = "attack_attempt"
    type     = "custom_ioc"
  }

  path_glob = "/db/*"

  conditions {
    operator = "match_regex"
    parameters {
      inputs {
        address = "server.db.statement"
      }
      regex = "stmt.*"
    }
  }

  action {
    action = "redirect_request"
    parameters {
      status_code = 302
      location    = "/blocking"
    }
  }
}


# Create a WAF custom rule to track business logic events
resource "datadog_appsec_waf_custom_rule" "biz000" {
  name = "Track payments"

  blocking = false
  enabled  = true

  tags = {
    category = "business_logic"
    type     = "payment.checkout"
  }

  path_glob = "/cart/*"

  conditions {
    operator = "capture_data"
    parameters {
      inputs {
        address  = "server.request.query"
        key_path = ["payment_id"]
      }
      value = "payment"
    }
  }

  scope {
    env     = "prod"
    service = "paymentsvc"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `blocking` (Boolean) Indicates whether the WAF custom rule will block the request.
- `enabled` (Boolean) Indicates whether the WAF custom rule is enabled.
- `name` (String) The Name of the WAF custom rule.
- `tags` (Map of String) Tags associated with the WAF custom rule. `category` and `type` tags are required. Supported categories include `business_logic`, `attack_attempt` and `security_response`.

### Optional

- `action` (Block, Optional) (see [below for nested schema](#nestedblock--action))
- `conditions` (Block List) (see [below for nested schema](#nestedblock--conditions))
- `path_glob` (String) The path glob for the WAF custom rule.
- `scope` (Block List) (see [below for nested schema](#nestedblock--scope))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--action"></a>
### Nested Schema for `action`

Optional:

- `action` (String) Override the default action to take when the WAF custom rule would block.
- `parameters` (Block, Optional) (see [below for nested schema](#nestedblock--action--parameters))

<a id="nestedblock--action--parameters"></a>
### Nested Schema for `action.parameters`

Optional:

- `location` (String) The location to redirect to when the WAF custom rule triggers.
- `status_code` (Number) The status code to return when the WAF custom rule triggers.



<a id="nestedblock--conditions"></a>
### Nested Schema for `conditions`

Optional:

- `operator` (String) Operator to use for the WAF Condition.
- `parameters` (Block, Optional) (see [below for nested schema](#nestedblock--conditions--parameters))

<a id="nestedblock--conditions--parameters"></a>
### Nested Schema for `conditions.parameters`

Optional:

- `data` (String) Identifier of a list of data from the denylist. Can only be used as substitution from the list parameter.
- `inputs` (Block List) (see [below for nested schema](#nestedblock--conditions--parameters--inputs))
- `list` (List of String) List of value to use with the condition. Only used with the phrase_match, !phrase_match, exact_match and !exact_match operator.
- `options` (Block, Optional) (see [below for nested schema](#nestedblock--conditions--parameters--options))
- `regex` (String) Regex to use with the condition. Only used with match_regex and !match_regex operator.
- `value` (String) Store the captured value in the specified tag name. Only used with the capture_data operator.

<a id="nestedblock--conditions--parameters--inputs"></a>
### Nested Schema for `conditions.parameters.inputs`

Optional:

- `address` (String) Input from the request on which the condition should apply.
- `key_path` (List of String) Specific path for the input.


<a id="nestedblock--conditions--parameters--options"></a>
### Nested Schema for `conditions.parameters.options`

Optional:

- `case_sensitive` (Boolean) Evaluate the value as case sensitive.
- `min_length` (Number) Only evaluate this condition if the value has a minimum amount of characters.




<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Optional:

- `env` (String) The environment scope for the WAF custom rule.
- `service` (String) The service scope for the WAF custom rule.

## Import

Import is supported using the following syntax:

```shell
terraform import datadog_appsec_waf_custom_rule.new_list ""
```
