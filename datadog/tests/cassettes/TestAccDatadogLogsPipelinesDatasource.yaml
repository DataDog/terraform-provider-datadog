---
version: 2
interactions:
    - id: 0
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 478.070375ms
    - id: 1
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 262.75575ms
    - id: 2
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 138.402583ms
    - id: 3
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 143.455458ms
    - id: 4
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 135.101125ms
    - id: 5
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: api.datadoghq.com
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Accept:
                - application/json
        url: https://api.datadoghq.com/api/v1/logs/config/pipelines
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding:
            - chunked
        trailer: {}
        content_length: -1
        uncompressed: true
        body: |
            [{"id":"LWIrk9TLT3Kp9hnIbWBs2w","type":"pipeline","name":"Jenkins","is_enabled":false,"is_read_only":false,"filter":{"query":"source:jenkins service:jenkins"},"processors":[{"type":"pipeline","name":"Jenkins Main Logs","is_enabled":true,"filter":{"query":"@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse the log message","is_enabled":false,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSS+0000\"):date}\n_id \\[id\\=%{integer:id}\\]\n_level %{word:level}\n_logger (\\w+|\\.)+?%{regex(\"([a-zA-Z0-9]+[.][a-zA-Z0-9]+)\"):logger.name}\\#%{data:logger.label}\n_message %{data:message}\n","match_rules":"rule %{_date}\\s+%{_id}\\s+%{_level}\\s+%{_logger}\\:\\s+%{_message}"},"type":"grok-parser"},{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2020-09-11 18:39:27.168+0000 [id=301]\tWARNING\thudson.model.RunMap#retrieve: could not load /var/lib/jenkins/jobs/process_label/builds/11396","2020-09-11 17:53:17.279+0000 [id=1882974]\tINFO\thudson.plugins.ec2.EC2Cloud#log: The instance EC2 (Platform Nodes) - Code Pipeline Dedicated Large (i-00ccbfe7626e67d47) has a blank console. Maybe the console is yet not available. If enough time has passed, consider changing the key verification strategy or the AMI used by one printing out the host key in the instance console","2020-09-11 18:34:55.043+0000 [id=1889960]\tINFO\th.plugins.ec2.EC2OndemandSlave#lambda$terminate$0: Removed EC2 instance from jenkins master: i-00c77ed6825a0283a","2020-09-11 18:11:29.118+0000 [id=1885120]\tSEVERE\to.d.j.p.datadog.DatadogUtilities#severe: An unexpected error occurred","2020-09-11 18:35:24.327+0000 [id=1889974]\tINFO\th.p.ec2.EC2RetentionStrategy#taskAccepted: Agent i-09d6bcf24ed8d123f has 9 builds left"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status (%{word:level}|\\[%{word:level}\\s*\\])\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+(\\(%{_logger_name}:%{_line}\\)|%{_logger_name})\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_custom_jenkins (%{_date}|%{_date_ms}|%{_date_slf4j})(\\+0000)?\\s+\\[(id=)?%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}:\\s+?%{data:message}((\\n|\\t)%{data:error.stack})?\n"},"type":"grok-parser"}]},{"type":"pipeline","name":"Jenkins Job Logs","is_enabled":true,"filter":{"query":"-@tailed_path:\"/var/lib/jenkins/logs/jenkins.log\" source:jenkins service:jenkins"},"processors":[{"name":"parse tailed_path","is_enabled":true,"source":"tailed_path","samples":["/var/lib/jenkins/jobs/pipeline/jobs/admin/jobs/venmo-platform-pr-controller/builds/52228/log","/var/lib/jenkins/jobs/pipeline/jobs/default/jobs/venmo-platform-pr-foundation-swagger-missing-descriptions/builds/5210/log","/var/lib/jenkins/jobs/update_datadog_metrics/builds/49760/log"],"grok":{"support_rules":"_job %{data:jenkins.job}\n_build %{data:jenkins.build}\n","match_rules":"pipeline_job_rule /var/lib/jenkins/jobs/pipeline/jobs/%{data:jenkins.pipeline}/jobs/%{_job}/builds/%{_build}/log\nnon_pipeline_job_rule /var/lib/jenkins/jobs/%{_job}/builds/%{_build}/log\n"},"type":"grok-parser"}]}]},{"id":"XCYdgKpPQFKyhKexiTkbcQ","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":true,"filter":{"query":"source:fly_io"},"processors":[{"name":"Map attribute `env` to a tag","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `fly.app.name` as the official service of the log","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}]},{"id":"TL1aouiMTNmpCCN1iZxoSA","type":"pipeline","name":"Ruby","is_enabled":true,"is_read_only":true,"filter":{"query":"source:ruby"},"processors":[{"name":"Map `logger` to `logger.name`","is_enabled":true,"sources":["logger"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread` to `logger.thread_name`","is_enabled":true,"sources":["thread"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Ruby Default formats","is_enabled":true,"source":"message","samples":["I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.2ms)","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Started GET \"/api/v1/example/query\" for 123.123.123.123 at 1999-03-03 02:34:24+0000","I, [1999-03-03T02:34:24.895701 #19074]  INFO -- : Processing by MyCheck::CheckController#index as JSON","I, [2018-06-27T08:01:52.991728 #1]  INFO -- : Received: {\"action\":\"cancel\",\"order\":{\"id\":1234567,\"timestamp\":153012312}}","[2019-01-16 15:38:45 +0000][my_app][WARN][dd.trace_id=7396234561907730428 dd.span_id=1152346429682372911] This is a test message!"],"grok":{"support_rules":"_date (?:%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSS\"):date}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):date})\n_status %{word:level}\n_thread_id %{word:logger.thread_id}\n_thread_name %{notSpace:logger.thread_name}\n_logger_name %{notSpace:logger.name}\n_ruby_log_prefix %{word}, \\[%{_date} #%{_thread_id}\\]\\s+%{_status}\\s+--\\s+(?:%{_logger_name})?:(?:\\s+%{_trace_rule})?\n_trace_rule \\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\n_datadog_prefix \\[%{date(\"yyyy-MM-dd HH:mm:ss Z\"):date}\\]\\[%{word:application}\\]\\[%{_status}\\]%{_trace_rule}\n_activate_status %{word:active_directory.process_status}\n","match_rules":"# Active Directory Rails logs\n\ncompleted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{integer:http.status_code}(?: (?:%{word}|Internal Server Error))? in %{number:duration}ms \\((?>Views: %{number:views}ms \\| )?ActiveRecord: %{number:activerecord}ms\\)\n\nprocessing_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} by %{notSpace:processor}.*\n\nstarted_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?%{_activate_status} %{word:http.method} \"%{notSpace:http.url_details.path}\" for %{ipOrHost:network.client.ip}.*\n\ndatadog_format %{_datadog_prefix} %{data::keyvalue(\"=\",\"/\")}(?>(\\n|\\t)%{data:error.stack})?\n\nreceived_rule (?>%{_ruby_log_prefix}\\s+|%{_trace_rule}\\s+)?Received: %{data::json}\n\n## Default Ruby formats\nRuby_default %{_ruby_log_prefix}\\s+%{data:error.message}(?>(\\n|\\t)%{data:error.stack})?\n\nRuby_keyvalue %{data::keyvalue(\"=\",\"/\")}\n\n# Extra samples:\n#I, [1999-03-03T02:34:24.895701 #19074]  INFO -- Main: Some error.\n## Datadog Format\n#[dd.trace_id=1321281354128614668 dd.span_id=5986620922286636160] Completed 200 OK in 9ms (Views: 6.3ms | ActiveRecord: 1.0ms)\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Parsing Stack trace","is_enabled":true,"source":"error.stack","samples":["ZeroDivisionError: divided by 0\nfrom devide.rb:6:in `divide`  \nfrom devide.rb:14:in `call`\nfrom devide.rb:18:in `<main>`\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Map `method` to `http.method`","is_enabled":true,"sources":["method"],"source_type":"attribute","target":"http.method","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `path` to `http.url_details.path`","is_enabled":true,"sources":["path"],"source_type":"attribute","target":"http.url_details.path","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `status` to `http.status_code`","is_enabled":true,"sources":["status"],"source_type":"attribute","target":"http.status_code","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"},{"name":"Convert duration unit ms to ns","is_enabled":true,"expression":"duration*1000000","target":"duration","is_replace_missing":false,"type":"arithmetic-processor"}]},{"id":"rTxbr2MpQsSCEtn66XmwnQ","type":"pipeline","name":"python","is_enabled":true,"is_read_only":true,"filter":{"query":"source:python"},"processors":[{"name":"Parsing python default format","is_enabled":true,"source":"message","samples":["2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log","2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext","2020-03-20 14:15:07,124 INFO [root] [app.py:78] [dd.service=excelsior dd.env=prod dd.version=abc123 dd.trace_id=9659687005038611690 dd.span_id=6632586210846541907] - This is a test of info logs","2021-07-09 8:58:31,137 WARNING [root] [views.py:42] [dd.service=datadoggo dd.env=prod dd.version=abc546 dd.trace_id=2296056412404370861 dd.span_id=16818077145337196836] - New post view.","2017-12-26T10:44:59,311 ERROR [dd.dogweb.lib.static_asset] [20081] rid=b0RV4J Error reading statics_version file.Traceback (most recent call last): File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"_datadog_prefix (%{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}|%{date(\"yyyy-MM-dd H:mm:ss,SSS\"):timestamp}) %{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{notSpace:filename}:%{number:lineno}\\]\\s+\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\] -\n_python_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+\\[%{notSpace:process.name}\\]\\s+\\[%{integer:process.id}\\]\n_message_with_keyvalue %{regex(\"(?<message>.*)\")::keyvalue}\n","match_rules":"traceback_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}Traceback \\(most recent call last\\):(?s)\\s*%{data:error.stack}\npython_format (%{_python_prefix}|%{_datadog_prefix})\\s+%{_message_with_keyvalue}\npython_fallback %{date(\"yyyy-MM-dd'T'HH:mm:ss','SSS\"):timestamp}\\s+%{word:levelname}\\s+%{_message_with_keyvalue}((\\n|\\t)%{data:error.stack})?\n#Samples\n#2017-12-19T14:37:58,995 INFO  [process.name] [20081] this is my python log\n# Datadog format\n#2019-01-07 15:20:15,972 DEBUG [flask.app] [app.py:100] [dd.trace_id=5688176451479556031 dd.span_id=4663104081780224235] - Hook: teardown_appcontext\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `levelname` as the official status of the log","is_enabled":true,"sources":["levelname"],"type":"status-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Map `traceback` to `error.stack`","is_enabled":true,"sources":["traceback"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `name` to `logger.name`","is_enabled":true,"sources":["name"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `threadName` to `logger.thread_name`","is_enabled":true,"sources":["threadName"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `exc_info` to `error.stack`","is_enabled":true,"sources":["exc_info"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing python traceback","is_enabled":true,"source":"error.stack","samples":["File \"/home/pythonrepo/lib/asset.py\", line 16, in version    with open(\"/etc/statics_version.txt\", \"r\") as statics_version_file: IOError: [Errno 2] No such file or directory: /etc/statics_version.txt"],"grok":{"support_rules":"","match_rules":"parsing_traceback File \"%{notSpace:filename}\", line %{integer:lineno}.*\\s+%{regex(\"[a-zA-Z]*Error[a-zA-Z]*\"):error.kind}: %{data:error.message}\n"},"type":"grok-parser"},{"name":"Map `extra.dd.span_id`, `record.extra.dd.span_id` to `dd.span_id`","is_enabled":true,"sources":["extra.dd.span_id","record.extra.dd.span_id"],"source_type":"attribute","target":"dd.span_id","target_type":"attribute","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.trace_id`, `extra.dd.trace_id`, `record.extra.dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id","extra.dd.trace_id","record.extra.dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env`, `extra.dd.env`, `record.extra.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","extra.dd.env","record.extra.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `extra.dd.version`, `record.extra.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","extra.dd.version","record.extra.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `extra.dd.service`, `record.extra.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","extra.dd.service","record.extra.dd.service"],"type":"service-remapper"}]},{"id":"2QGdoZWESWi6WArjxl4cxg","type":"pipeline","name":"my first pipeline","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"}]},{"id":"0mc2Xh9XTOKHDRooX8oU7Q","type":"pipeline","name":"sample pipeline update","is_enabled":true,"is_read_only":false,"filter":{"query":"source:foo"},"processors":[{"name":"sample grok parser","is_enabled":true,"source":"message","samples":["Rule fooo 1.2"],"grok":{"support_rules":"","match_rules":"Rule %{word:my_word2} %{number:my_float2}"},"type":"grok-parser"},{"name":"sample message remapper","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"htXFf5DCQ_ay1IhQ9Tr4uw","type":"pipeline","name":"Golang","is_enabled":true,"is_read_only":true,"filter":{"query":"source:go"},"processors":[{"name":"Parsing Go Default formats","is_enabled":true,"source":"message","samples":["[Oct 27 02:18:00] DEBUG main: started observing beach animal=walrus","2017/03/02 16:07:16 You cannot divide by 0"],"grok":{"support_rules":"_date %{date(\"yyyy/MM/dd HH:mm:ss\"):date}\n_date_prefix %{date(\"MMM dd HH:mm:ss\"):date}\n_status %{word:level}\n_thread_name %{notSpace:logger.thread_name}\n","match_rules":"go_prefixed \\[%{_date_prefix}\\]\\s+%{_status}\\s+%{_thread_name}: %{data:message}\n\ngo_default %{_date} %{data:error.message}\n"},"type":"grok-parser"},{"name":"Extracting keyvalue","is_enabled":true,"source":"message","samples":["timestamp=\"2015-03-26T01:27:38-04:00\" level=debug msg=\"Started observing beach\" animal=walrus number=8"],"grok":{"support_rules":"","match_rules":"go_fallback %{data::keyvalue}\n"},"type":"grok-parser"},{"name":"Map `exception`, `stack_trace` to `error.stack`","is_enabled":true,"sources":["exception","stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg`, `message` as the official message of the log","is_enabled":true,"sources":["msg","message"],"type":"message-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"pMhyxnUeS6ugpnLdWckGIw","type":"pipeline","name":"glog pipeline","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(admission-webhook OR api-server OR cert-manager-acmesolver OR cert-manager-cainjector OR cert-manager-controller OR cert-manager-webhook OR cluster-proportional-autoscaler-amd64 OR goldilocks OR hyperkube OR ip-masq-agent OR k8s-prometheus-adapter-amd64 OR kube-apiserver OR kube-controller-manager OR kube-proxy OR kube-state-metrics OR metacontroller OR metrics-server-amd64 OR prometheus-operator OR vpa-admission-controller OR vpa-recommender OR vpa-updater)"},"processors":[{"name":"Parsing glog format logs","is_enabled":true,"source":"message","samples":["I0402 08:06:51.571361       1 static_autoscaler.go:366] Calculating unneeded nodes","I0402 08:06:51.571361       1 k8sclient.go:251] Replicas are not as expected : updating replicas from 37 to 36","E0402 08:06:51.571361       1 authentication.go:65] Unable to authenticate the request due to an error: x509: certificate has expired or is not yet valid"],"grok":{"support_rules":"","match_rules":"glog_rule %{regex(\"[IWEF]\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"7YBUZ3J_RJGDRk6b5ayIIQ","type":"pipeline","name":"CoreDNS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:coredns"},"processors":[{"name":"Parsing Coredns logs","is_enabled":true,"source":"message","samples":["[INFO] 127.0.0.1:50759 - 29008 \"A IN example.org. udp 41 false 4096\" NOERROR qr,rd,ra,ad 68 0.037990251s"],"grok":{"support_rules":"","match_rules":"dns_common_format (%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSZ\"):timestamp}|%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp})?\\s*\\[%{word:level}\\] %{notSpace:network.client.ip}:%{port:network.client.port} - %{number:dns.id} \"%{word:dns.question.type} %{word:dns.question.class} %{hostname:dns.question.name} %{word:dns.protocol} %{number:dns.question.size} %{word:dns.dnssec} %{number:dns.buffer}\" %{word:dns.flags.rcode} %{notSpace:dns.flags.list:array(\",\")} %{number:dns.answer.size} %{number:duration:scale(1000000000)}s.*\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UodPu7HbQ-Gcp2K1aZBRhw","type":"pipeline","name":"Kube Scheduler (glog)","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(kube_scheduler OR kube-scheduler)"},"processors":[{"name":"Parsing Kube Scheduler logs","is_enabled":true,"source":"message","samples":["W0424 11:47:41.605188       1 authorization.go:47] Authorization is disabled","I0424 11:47:41.605254       1 deprecated_insecure_serving.go:49] Serving healthz insecurely on 127.0.0.1:10251","E0424 11:47:46.923664       1 reflector.go:134] k8s.io/client-go/informers/factory.go:132: Failed to list *v1.PersistentVolumeClaim: persistentvolumeclaims is forbidden: User \"system:kube-scheduler\" cannot list resource \"persistentvolumeclaims\" in API group \"\" at the cluster scope"],"grok":{"support_rules":"","match_rules":"kube_scheduler %{regex(\"\\\\w\"):level}%{date(\"MMdd HH:mm:ss.SSSSSS\"):timestamp}\\s+%{number:logger.thread_id} %{notSpace:logger.name}:%{number:lineno}\\] %{data:msg}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"K2HR3G6PSlC_KIhceFuxig","type":"pipeline","name":"etcd","is_enabled":true,"is_read_only":true,"filter":{"query":"source:etcd"},"processors":[{"name":"Parsing etcd logs","is_enabled":true,"source":"message","samples":["2020-08-20 18:19:25.769683 I | embed: ready to serve client requests","2020-08-20 18:23:44.714594 W | rafthttp: lost the TCP streaming connection with peer d282ac2ce600c1ce (stream Message reader)","2020-08-20 18:23:44.721706 E | rafthttp: failed to dial d282ac2ce600c1ce on stream Message (peer d282ac2ce600c1ce failed to find local node cf1d15c5d194b5c9)"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date}\n","match_rules":"etcd %{_date} %{word: level} \\| (%{notSpace:package}: )?%{data:message}\n"},"type":"grok-parser"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"UBNUhCTxR_Goiw7w4wEOlw","type":"pipeline","name":"NodeJS","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nodejs"},"processors":[{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"},{"name":"Parsing NodeJs logs","is_enabled":true,"source":"message","samples":["[2019-10-21T15:13:23.419] [INFO] default - An info message","[dd.trace_id=123abc dd.span_id=1234abc] [2019-10-21T15:13:23.419] [INFO] default - An info message","[2019-10-21T15:13:23.419] [INFO] default - [dd.trace_id=123abc dd.span_id=1234abc] An info message","GET www.google.com 304 5000 - 2.306 ms","::1 - - [21/Oct/2019:19:16:34 +0000] \"GET / HTTP/1.1\" 504 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\""],"grok":{"support_rules":"","match_rules":"log4js_format (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?\\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSS\"):time}\\]\\s+\\[%{word:level}\\] %{data::keyvalue}\n\nweb_access_morgan %{word:http.method} %{notSpace:http.url} %{number:http.status_code} (-|%{number:network.bytes_written}) - (%{number:duration:scale(1000000)} ms|%{number:duration:scale(1000000000)} s)\n\nmorgan_combined %{ipOrHost:network.client.ip} %{notSpace:http.ident:nullIf(\"-\")} %{notSpace:http.auth:nullIf(\"-\")} \\[%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\\] \"(?>%{word:http.method} |)%{notSpace:http.url}(?> HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}|)\" %{number:http.status_code} (?>%{number:network.bytes_written}|-) \"%{notSpace:http.referer}\" \"%{regex(\"[^\\\\\\\"]*\"):http.useragent}\".*\n\nfallback (?>\\[%{data::keyvalue}dd.trace_id=%{word:dd.trace_id} dd.span_id=%{word:dd.span_id}\\]\\s*)?%{data::json}\n"},"type":"grok-parser"},{"name":"Define `time` as the official date of the log","is_enabled":true,"sources":["time"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Transform bunyan level in regular level","is_enabled":true,"categories":[{"filter":{"query":"@level:10"},"name":"trace"},{"filter":{"query":"@level:20"},"name":"debug"},{"filter":{"query":"@level:30"},"name":"info"},{"filter":{"query":"@level:40"},"name":"warning"},{"filter":{"query":"@level:50"},"name":"error"},{"filter":{"query":"@level:60"},"name":"fatal"}],"target":"bunyan_level","type":"category-processor"},{"name":"Define `http.status_category`, `bunyan_level`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","bunyan_level","level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Map attribute `dd.env` to tag `env`","is_enabled":true,"sources":["dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version` to tag `version`","is_enabled":true,"sources":["dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service"],"type":"service-remapper"}]},{"id":"cgS5obmTSi6NgGX05lf0tg","type":"pipeline","name":"Web Browser logs","is_enabled":true,"is_read_only":true,"filter":{"query":"source:browser"},"processors":[{"name":"Parsing the backend endpoint url","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Parsing the url of the current page","is_enabled":true,"sources":["view.url"],"target":"view.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Parsing the url of the previous page","is_enabled":true,"sources":["view.referrer"],"target":"view.referrer_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["network.client.ip"],"target":"network.client.geoip","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"}]},{"id":"JW6WRX6zSYO6P27n-R85vw","type":"pipeline","name":"Java","is_enabled":true,"is_read_only":true,"filter":{"query":"source:java"},"processors":[{"name":"Parsing Java Default formats","is_enabled":true,"source":"message","samples":["2000-09-07 14:07:41,508 [main] INFO  MyApp - Entering application.","54 [main] INFO MyApp.foo.bar - Entering application.","2000-09-07 14:07:44 INFO org.foo.bar:32 - Entering application.","2000-09-07 14:07:44.452 [main] INFO org.foo.bar - Entering application.","2022-10-31 17:22:39.331  INFO 82578 --- [  restartedMain] a.s.o.SpringBootElasticSearchApplication : Starting SpringBootElasticSearchApplication using Java 17.0.4.1 on xxx"],"grok":{"support_rules":"_date %{date(\"yyyy-MM-dd HH:mm:ss\"):timestamp}\n_date_ms %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}\n_date_slf4j %{date(\"yyyy-MM-dd HH:mm:ss.SSS\"):timestamp}\n_duration %{integer:duration}\n_thread_name %{notSpace:logger.thread_name}\n_status %{word:level}\n_logger_name %{notSpace:logger.name}\n_context %{notSpace:logger.context}\n_line %{integer:line}\n","match_rules":"java_default (%{_date_ms}|%{_duration})\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_slf4j %{_date_slf4j}\\s+\\[%{_thread_name}\\]\\s+%{_status}\\s+%{_logger_name}\\s*(%{_context}\\s*)?- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_log4j %{_date} %{_status}\\s+%{_logger_name}:%{_line}\\s+- (?>%{word:dd.trace_id} %{word:dd.span_id} - )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_fallback (%{_date}|%{_date_ms}) %{_status}\\s+(?>%{word:dd.trace_id} %{word:dd.span_id} )?%{data:message}((\\n|\\t)%{data:error.stack})?\n\njava_spring_boot %{_date_slf4j}\\s+%{_status} %{integer:pid} --- \\[\\s*%{_thread_name}\\] %{_logger_name}\\s+: %{data:message}((\\n|\\t)+%{data:error.stack})?\n"},"type":"grok-parser"},{"name":"Parsing GC logs","is_enabled":true,"source":"message","samples":["[9237.485s][info   ][gc] GC(835) Pause Young (G1 Evacuation Pause) 4937M->645M(7168M) 17.476ms","2019-03-20T14:36:30.111+0000: 41.098: [GC concurrent-mark-end, 0.0272767 secs]","2019-03-20T14:36:30.111+0000: 41.071: [GC concurrent-mark-start]","2019-03-20T14:36:30.111+0000: 41.099: [Finalize Marking, 0.0011661 secs]","[2022-11-18T16:01:51.599+0000][4267.762s][info][gc] GC(2917) Concurrent Mark Cycle"],"grok":{"support_rules":"_gc_event_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\n_parallel \\[Parallel\\sTime:\\s%{number:parallel_time}\\sms,\\sGC\\sWorkers:\\s%{number:gc_worker.count}]\n\n_gc_worker_start \\[GC\\sWorker\\sStart\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.start.min},\\sAvg:\\s%{number:gc_worker.start.avg},\\sMax:\\s%{number:gc_worker.start.max},\\sDiff:\\s%{number:gc_worker.start.diff}]\n\n_ext_root_scanning \\[Ext\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:exit_root_scanning.min},\\sAvg:\\s%{number:exit_root_scanning.avg},\\sMax:\\s%{number:exit_root_scanning.max},\\sDiff:\\s%{number:exit_root_scanning.diff},\\sSum:\\s%{number:exit_root_scanning.sum}]\n\n_update_rs \\[Update\\sRS\\s\\(ms\\):\\sMin:\\s%{number:update_rs.min},\\sAvg:\\s%{number:update_rs.avg},\\sMax:\\s%{number:update_rs.max},\\sDiff:\\s%{number:update_rs.diff},\\sSum:\\s%{number:update_rs.sum}]\n\n_gcc_event %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}:%{notSpace}\\s\\[%{regex(\"([^\\\\]]*)\"):event.type}]\n\n_processed_buffer \\[Processed\\sBuffers:\\sMin:\\s%{number:processed_buffer.min},\\sAvg:\\s%{number:processed_buffer.avg},\\sMax:\\s%{number:processed_buffer.max},\\sDiff:\\s%{number:processed_buffer.diff},\\sSum:\\s%{number:processed_buffer.sum}]\n\n_scan_rs \\[Scan\\sRS\\s\\(ms\\):\\sMin:\\s%{number:scan_rs.min},\\sAvg:\\s%{number:scan_rs.avg},\\sMax:\\s%{number:scan_rs.max},\\sDiff:\\s%{number:scan_rs.diff},\\sSum:\\s%{number:scan_rs.sum}]\n\n_code_root_scan \\[Code\\sRoot\\sScanning\\s\\(ms\\):\\sMin:\\s%{number:code_root.scan.min},\\sAvg:\\s%{number:code_root.scan.avg},\\sMax:\\s%{number:code_root.scan.max},\\sDiff:\\s%{number:code_root.scan.diff},\\sSum:\\s%{number:code_root.scan.sum}]\n\n_object_copy \\[Object\\sCopy\\s\\(ms\\):\\sMin:\\s%{number:object_copy.min},\\sAvg:\\s%{number:object_copy.avg},\\sMax:\\s%{number:object_copy.max},\\sDiff:\\s%{number:object_copy.diff},\\sSum:\\s%{number:object_copy.sum}]\n\n_termination \\[Termination\\s\\(ms\\):\\sMin:\\s%{number:termination.min},\\sAvg:\\s%{number:termination.avg},\\sMax:\\s%{number:termination.max},\\sDiff:\\s%{number:termination.diff},\\sSum:\\s%{number:termination.sum}]\n\n_termination_attempts \\[Termination\\sAttempts:\\sMin:\\s%{number:termination.attempts.min},\\sAvg:\\s%{number:termination.attempts.avg},\\sMax:\\s%{number:termination.attempts.max},\\sDiff:\\s%{number:termination.attempts.diff},\\sSum:\\s%{number:termination.attempts.sum}]\n\n_gc_worker_other \\[GC\\sWorker\\sOther\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.other.min},\\sAvg:\\s%{number:gc_worker.other.avg},\\sMax:\\s%{number:gc_worker.other.max},\\sDiff:\\s%{number:gc_worker.other.diff},\\sSum:\\s%{number:gc_worker.other.sum}]\n\n_gc_worker_total \\[GC\\sWorker\\sTotal\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.total.min},\\sAvg:\\s%{number:gc_worker.total.avg},\\sMax:\\s%{number:gc_worker.total.max},\\sDiff:\\s%{number:gc_worker.total.diff},\\sSum:\\s%{number:gc_worker.total.sum}]\n\n_gc_worker_end \\[GC\\sWorker\\sEnd\\s\\(ms\\):\\sMin:\\s%{number:gc_worker.end.min},\\sAvg:\\s%{number:gc_worker.end.avg},\\sMax:\\s%{number:gc_worker.end.max},\\sDiff:\\s%{number:gc_worker.end.diff}]\n\n_code_root_fixup \\[Code\\sRoot\\sFixup:\\s%{number:code_root.fixup}\\sms]\n\n_code_root_purge \\[Code\\sRoot\\sPurge:\\s%{number:code_root.purge}\\sms]\n\n_clear_ct \\[Clear\\sCT:\\s%{number:clear_ct}\\sms]\n\n_other \\[Other:\\s%{number:other}\\sms]\n\n_choose_cset \\[Choose\\sCSet:\\s%{number:choose_cset}\\sms]\n\n_ref_proc \\[Ref\\sProc:\\s%{number:ref.proc}\\sms]\n\n_ref_enq \\[Ref\\sEnq:\\s%{number:ref.enq}\\sms]\n\n_redirty_cards \\[Redirty\\sCards:\\s%{number:redirty_cards}\\sms]\n\n_humongous_register \\[Humongous\\sRegister:\\s%{number:humongous_register}\\sms]\n\n_humongous_reclaim \\[Humongous\\sReclaim:\\s%{number:humongous_reclaim}\\sms]\n\n_free \\[Free\\sCSet:\\s%{number:free}\\sms]\n\n_memory_usage \\[Eden: (%{number:eden.memory_before}M|%{number:eden.memory_before:scale(1000)}G)\\((%{number:eden.memory_allocated_before}M|%{number:eden.memory_allocated_before:scale(1000)}G)\\)->%{number:eden.memory_after}B\\((%{number:eden.memory_allocated_after}M|%{number:eden.memory_allocated_after:scale(1000)}G)\\)\\sSurvivors:\\s%{number:survivor.memory_before}M->%{number:survivor.memory_after}M\\sHeap:\\s(%{number:heap.memory_before}M|%{number:heap.memory_before:scale(1000)}G)\\((%{number:heap.memory_allocated_before}M|%{number:heap.memory_allocated_before:scale(1000)}G)\\)->%{number:heap.memory_after}M\\((%{number:heap.memory_allocated_after}M|%{number:heap.memory_allocated_after:scale(1000)}G)\\)]\n\n_times \\[Times:\\suser=%{number:times.user}\\ssys=%{number:times.system},\\sreal=%{number:times.real}\\ssecs]\n","match_rules":"gc_nonverbose_basic \\[%{notSpace}\\]\\[%{word:level}\\s*\\]\\[%{word:gc.type}\\] GC\\(%{number:gc.iteration}\\) %{data:gc.action} \\(%{data:gc.phase}\\) %{number:heap.memory_before}M\\-\\>%{number:heap.memory_after}M\\(%{number:heap.memory_total}M\\) %{number:duration:scale(1000000)}ms\n\ngc_action_phase_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[GC\\s%{notSpace:gc.action}(\\s%{regex(\"([^,]*)\"):gc.phase},)?(\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\nnon_gc_action_duration %{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}: %{notSpace}\\s\\[%{regex(\"([^,]*)\"):gc.action}(,\\s%{number:duration:scale(1000000000)}\\ssecs)?]\n\ngc_verbose %{_gc_event_phase_duration}(\\r|\\n|\\s)*%{_parallel}(\\r|\\n|\\s)*%{_gc_worker_start}(\\r|\\n|\\s)*%{_ext_root_scanning}(\\r|\\n|\\s)*%{_update_rs}(\\r|\\n|\\s)*%{_processed_buffer}(\\r|\\n|\\s)*%{_scan_rs}(\\r|\\n|\\s)*%{_code_root_scan}(\\r|\\n|\\s)*%{_object_copy}(\\r|\\n|\\s)*%{_termination}(\\r|\\n|\\s)*%{_termination_attempts}(\\r|\\n|\\s)*%{_gc_worker_other}(\\r|\\n|\\s)*%{_gc_worker_total}(\\r|\\n|\\s)*%{_gc_worker_end}(\\r|\\n|\\s)*%{_code_root_fixup}(\\r|\\n|\\s)*%{_code_root_purge}(\\r|\\n|\\s)*%{_clear_ct}(\\r|\\n|\\s)*%{_other}(\\r|\\n|\\s)*%{_choose_cset}(\\r|\\n|\\s)*%{_ref_proc}(\\r|\\n|\\s)*%{_ref_enq}(\\r|\\n|\\s)*%{_redirty_cards}(\\r|\\n|\\s)*%{_humongous_register}(\\r|\\n|\\s)*%{_humongous_reclaim}(\\r|\\n|\\s)*%{_free}(\\r|\\n|\\s)*%{_memory_usage}(\\r|\\n|\\s)*%{_times}\n\ngc_new_format \\[%{date(\"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"):timestamp}\\](\\[%{number:duration:scale(1000000000)}s\\])?\\[%{notSpace:status}\\]\\[%{notSpace:gc.type}(\\s)?\\]\\sGC\\(%{number:gc.iteration}\\)\\s%{data:gc.action}(\\s%{number:duration:scale(1000000)}ms)?\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"},{"name":"Define `dd.trace_id` as the official trace ID of the log","is_enabled":true,"sources":["dd.trace_id"],"type":"trace-id-remapper"},{"name":"Map `stack_trace` to `error.stack`","is_enabled":true,"sources":["stack_trace"],"source_type":"attribute","target":"error.stack","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `logger_name`, `loggerName` to `logger.name`","is_enabled":true,"sources":["logger_name","loggerName"],"source_type":"attribute","target":"logger.name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Map `thread_name` to `logger.thread_name`","is_enabled":true,"sources":["thread_name"],"source_type":"attribute","target":"logger.thread_name","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Java Stack traces","is_enabled":true,"source":"error.stack","samples":["java.lang.NullPointerException: this is my error message\n at com.hello.world.flow.Checker.checkCacheEntryyy(Checker.java: 154)\n"],"grok":{"support_rules":"","match_rules":"error_rule %{notSpace:error.kind}: %{data:error.message}(\\n|\\t).*\n"},"type":"grok-parser"},{"name":"Calculate GC memory freed","is_enabled":true,"expression":"(heap.memory_before - heap.memory_after)","target":"gc.memory_freed","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Map attribute `dd.env`, `contextMap.dd.env` to tag `env`","is_enabled":true,"sources":["dd.env","contextMap.dd.env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Map attribute `dd.version`, `contextMap.dd.version` to tag `version`","is_enabled":true,"sources":["dd.version","contextMap.dd.version"],"source_type":"attribute","target":"version","target_type":"tag","preserve_source":false,"override_on_conflict":true,"type":"attribute-remapper"},{"name":"Define `dd.service`, `contextMap.dd.service` as the official service of the log","is_enabled":true,"sources":["dd.service","contextMap.dd.service"],"type":"service-remapper"},{"name":"Define `message` as the official message of the log","is_enabled":true,"sources":["message"],"type":"message-remapper"}]},{"id":"4I6FNy5GToqi2fKVAqNZJw","type":"pipeline","name":"Datadog Agent","is_enabled":true,"is_read_only":true,"filter":{"query":"source:(agent OR datadog-agent OR datadog-agent-cluster-worker OR datadog-cluster-agent OR process-agent OR security-agent OR system-probe OR trace-agent OR cluster-agent)"},"processors":[{"name":"Parsing Datadog Agent logs","is_enabled":true,"source":"message","samples":["2020-07-01 09:48:14 UTC | CORE | INFO | (pkg/collector/runner/runner.go:327 in work) | check:network,type:core | Done running check","2020-09-15 10:00:07 UTC | CORE | INFO | (pkg/collector/python/datadog_agent.go:120 in LogMessage) | kafka_cluster_status:8ca7b736f0aa43e5 | (kafka_cluster_status.py:213) | Checking for out of sync partition replicas","2019-04-08 13:53:48 UTC | TRACE | INFO | (pkg/trace/agent/agent.go:145 in loop) | exiting","2019-02-01 16:59:41 UTC | INFO | (connection_manager.go:124 in CloseConnection) | Connection closed","2020-11-18 10:31:13 UTC | JMX | INFO  | App | Successfully initialized instance: cassandra-localhost-7199"],"grok":{"support_rules":"","match_rules":"agent_rule         %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\) \\|( %{data::keyvalue(\":\")} \\|)?( - \\|)?( \\(%{notSpace:pyFilename}:%{number:pyLineno}\\) \\|)?%{data}\nagent_rule_pre_611 %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{word:level} \\| \\(%{notSpace:filename}:%{number:lineno} in %{word:process}\\)%{data}\njmxfetch_rule      %{date(\"yyyy-MM-dd HH:mm:ss z\"):timestamp} \\| %{notSpace:agent} \\| %{word:level}\\s+\\| %{word:class} \\| %{data}\n"},"type":"grok-parser"},{"name":"Define `timestamp` as the official date of the log","is_enabled":true,"sources":["timestamp"],"type":"date-remapper"},{"name":"Define `level` as the official status of the log","is_enabled":true,"sources":["level"],"type":"status-remapper"}]},{"id":"vL--Mbs7SceY84ADEYu40w","type":"pipeline","name":"Sinatra","is_enabled":true,"is_read_only":true,"filter":{"query":"source:sinatra"},"processors":[{"name":"Parsing Sinatra logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - - [15/Jul/2018:17:41:40 +0000] \"GET /uptime_status HTTP/1.1\" 200 34 0.0004","127.0.0.1 - - [15/Jul/2018 23:40:31] \"GET /uptime_status HTTP/1.1\" 200 6997 1.8096"],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access (%{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}|%{date(\"dd/MMM/yyyy HH:mm:ss\"):date_access})\n_duration %{number:duration:scale(1000000000)}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)( %{_duration}|-)?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"}]},{"id":"dRPabp5dQLO24WxISJq4mg","type":"pipeline","name":"openstack","is_enabled":true,"is_read_only":true,"filter":{"query":"source:openstack"},"processors":[{"name":"Parsing Openstack logs","is_enabled":true,"source":"message","samples":["192.168.42.11 - - [05/Apr/2019:15:21:40 +0000] \"GET /placement/resource_providers/fe0a06b8-9d03-4bb5-9790-3e142edbd996/allocations HTTP/1.1\" 200 346 \"-\" \"nova-compute keystoneauth1/3.13.1 python-requests/2.21.0 CPython/2.7.12\"","[Tue Apr 06 06:25:03.726614 2021] [mpm_event:notice] [pid 19269:tid 140081481041792] AH00489: Apache/2.4.18 (Ubuntu) mod_wsgi/4.3.0 Python/2.7.12 configured -- resuming normal operations","2020-04-08 14:10:08.946981 AH02454: uwsgi: attempt to connect to Unix domain socket /var/run/uwsgi/nova-api-wsgi.socket (uwsgi-uds-nova-api-wsgi) failed"],"grok":{"support_rules":"_bytes_written %{integer:network.bytes_written}\n_status_code %{integer:http.status_code}\n_auth %{notSpace:http.auth:nullIf(\"-\")}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP(S)?\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n_error_date (%{_wsgi_date}|%{_horizon_date})\n_wsgi_date \\[(%{date(\"EEE MMM dd HH:mm:ss.SSSSSS yyyy\"):date_access}|%{date(\"EEE MMM  d HH:mm:ss yyyy\"):date_access})\\]\n_horizon_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSSSS\"):date_access}\n_error_module_level \\[%{_module}:%{_level}\\]\n_module %{notSpace:module}\n_pid_tid \\[pid\\s+%{number:pid}:tid\\s+%{number:tid}\\]\n_level %{word:level}\n_libvirt_date %{date(\"yyyy-MM-dd HH:mm:ss.SSSZ\"):date_access}\n_libvirt_module %{notSpace:filename}:%{number:lineno}\n_cinder_date %{date(\"yyyy-MM-dd HH:mm:ss\"):date_access}\n","match_rules":"## This parser supports all logs from Openstack. More info here: https://docs.openstack.org/operations-guide/ops-logging.html\n\nerror_default %{_wsgi_date} %{_error_module_level} %{_pid_tid} %{data:msg}\n\nerror_horizon %{_horizon_date} %{data:msg}\n\nlibvirt_default %{_libvirt_date}:\\s+%{number:thread_no}:\\s+%{_level}\\s+:\\s+%{_libvirt_module}\\s+:\\s+%{data:msg}\n\ncinder_volume %{_cinder_date} %{number} %{_level} %{notSpace:module}\\s+(\\[-\\])?\\s+%{data:msg}\n\naccess.common %{_client_ip} %{_ident} (?>%{_auth} )?\\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) \"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category` as the official status of the log","is_enabled":true,"sources":["http.status_category"],"type":"status-remapper"},{"name":"Define `msg` as the official message of the log","is_enabled":true,"sources":["msg"],"type":"message-remapper"}]},{"id":"RSbXaJxLS8WSZbAV6vJnYg","type":"pipeline","name":"Nginx","is_enabled":true,"is_read_only":true,"filter":{"query":"source:nginx"},"processors":[{"name":"Parsing Nginx logs","is_enabled":true,"source":"message","samples":["127.0.0.1 - frank [13/Jul/2016:10:55:36 +0000] \"GET /apache_pb.gif HTTP/1.0\" 200 2326","172.17.0.1 - - [06/Jan/2017:16:16:37 +0000] \"GET /datadoghq/company?test=var1%20Pl HTTP/1.1\" 200 612 \"http://www.perdu.com/\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\" \"-\"","2017/09/26 14:36:50 [error] 8409#8409: *317058 \"/usr/share/nginx/html/sql/sql-admin/index.html\" is not found (2: No such file or directory), client: 217.92.148.44, server: localhost, request: \"HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1\", host: \"174.138.82.103\""],"grok":{"support_rules":"_auth %{notSpace:http.auth:nullIf(\"-\")}\n_bytes_written %{integer:network.bytes_written}\n_client_ip %{ipOrHost:network.client.ip}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n_url %{notSpace:http.url}\n_ident %{notSpace:http.ident:nullIf(\"-\")}\n_user_agent %{regex(\"[^\\\\\\\"]*\"):http.useragent}\n_referer %{notSpace:http.referer}\n_status_code %{integer:http.status_code}\n_method %{word:http.method}\n_date_access %{date(\"dd/MMM/yyyy:HH:mm:ss Z\"):date_access}\n_x_forwarded_for %{regex(\"[^\\\\\\\"]*\"):http._x_forwarded_for:nullIf(\"-\")}\n","match_rules":"access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-)\n\naccess.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.*\n\nerror.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})?\n"},"type":"grok-parser"},{"name":"Map `client` to `network.client.ip`","is_enabled":true,"sources":["client"],"source_type":"attribute","target":"network.client.ip","target_type":"attribute","preserve_source":false,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Parsing Nginx Error log requests","is_enabled":true,"source":"request","samples":["HEAD http://174.138.82.103:80/sql/sql-admin/ HTTP/1.1"],"grok":{"support_rules":"_method %{word:http.method}\n_url %{notSpace:http.url}\n_version HTTP\\/%{regex(\"\\\\d+\\\\.\\\\d+\"):http.version}\n","match_rules":"request_parsing (?>%{_method} |)%{_url}(?> %{_version}|)\n"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.url"],"target":"http.url_details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `date_access` as the official date of the log","is_enabled":true,"sources":["date_access"],"type":"date-remapper"},{"name":"Categorise status code","is_enabled":true,"categories":[{"filter":{"query":"@http.status_code:[200 TO 299]"},"name":"OK"},{"filter":{"query":"@http.status_code:[300 TO 399]"},"name":"notice"},{"filter":{"query":"@http.status_code:[400 TO 499]"},"name":"warning"},{"filter":{"query":"@http.status_code:[500 TO 599]"},"name":"error"}],"target":"http.status_category","type":"category-processor"},{"name":"Define `http.status_category`, `level` as the official status of the log","is_enabled":true,"sources":["http.status_category","level"],"type":"status-remapper"}]},{"id":"r-jB58U1TI6y_vJbBX2nzA","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Parse Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-06-26T15:25:13Z WARN             \"Failed to keep alive ssh server \\\"b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1\\\": ConditionalCheckFailedException: The conditional request failed\n{\n  RespMetadata: {\n    StatusCode: 400,\n    RequestID: \\\"5LUDO9VEIGQ436RMP6HEDM0D6FVV4KQNSO5AEMVJF66Q9ASUAAJG\\\"\n  },\n  Message_: \\\"The conditional request failed\\\"\n} (count=2, closing=false).\" inventory/controller.go:510"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"User Agent Processor","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Status remapper","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define 'date' as the log date","is_enabled":true,"sources":["date"],"type":"date-remapper"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"wLD85Kf3RiGkCu35OTl9KA","type":"pipeline","name":"Fly.io","is_enabled":true,"is_read_only":false,"filter":{"query":"source:fly_io "},"processors":[{"name":"Adding env as a tag key","is_enabled":true,"sources":["env"],"source_type":"attribute","target":"env","target_type":"tag","preserve_source":true,"override_on_conflict":false,"type":"attribute-remapper"},{"name":"Remapping app name to service","is_enabled":true,"sources":["fly.app.name"],"type":"service-remapper"},{"name":"Remapping log level as the status","is_enabled":true,"sources":["log.level"],"type":"status-remapper"}],"tags":[],"description":""},{"id":"C3rLxhf7RrOMi4M9rrBv6g","type":"pipeline","name":"Teleport","is_enabled":true,"is_read_only":true,"filter":{"query":"source:teleport"},"processors":[{"name":"Parsing Teleport Logs","is_enabled":true,"source":"message","samples":["2024-06-24T15:36:48Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:19954 cluster_name:teleport-plint code:T1000W ei:0 error:[invalid username, password or second factor] event:user.login method:local success:false time:2024-06-24T15:36:48.688Z uid:f9ec53d9-0263-43a3-a5e6-fc41351e63bb user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+(\\[%{notSpace:teleport.component}\\])?\\s+%{notSpace}\n\n_log_common_attr %{_log_prefix}\\s+(addr.local:%{ipOrHost:network.client.ip}:%{port:network.client.port}\\s+)?(addr.remote:%{ipOrHost:network.destination.ip}:%{port:network.destination.port}\\s+)?+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.eid}","match_rules":"parse_audit_user_login %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_leave %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audot_session_end %{_log_common_attr}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event_type}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_audit_session_data %{_log_common_attr}\\s+event:%{notSpace:teleport.event_type}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+rx:%{notSpace:teleport.bytes_read}\\s+server_hostname:%{notSpace:network.host.name}\\s+server_id:%{notSpace:teleport.server_id}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+tx:%{notSpace:network.bytes_written}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{regex(\"[^:]*\"):log.file}:%{number:log.line_number}.*\n\nparse_user_login %{_log_common_attr}\\s+error:%{regex(\"[\\\\[]*.*\\\\]\"):teleport.event_error}\\s+event:%{notSpace:teleport.event_type}\\s+method:%{notSpace:teleport.method}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):http.useragent}\\s%{notSpace}\n\nparse_common_prefix %{_log_prefix}.*"},"type":"grok-parser"},{"name":"","is_enabled":true,"sources":["http.useragent"],"target":"http.useragent_details","is_encoded":false,"type":"user-agent-parser"},{"name":"Define `log.level` as the official status of the log","is_enabled":true,"sources":["log.level"],"type":"status-remapper"},{"name":"Define `date` as the official date of the log","is_enabled":true,"sources":["date"],"type":"date-remapper"}]},{"id":"GJYHVcVzT6uN_0crZdRpzQ","type":"pipeline","name":"Teleport","is_enabled":false,"is_read_only":false,"filter":{"query":"source:teleport "},"processors":[{"name":"Teleport Audit Log (User Login)","is_enabled":true,"source":"message","samples":["2024-05-28T14:37:32Z INFO [AUDIT]     user.login addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I ei:0 event:user.login method:local mfa_device_name:otp-device mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68 required_private_key_policy:none success:true time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7 user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 events/emitter.go:288","2024-05-28T14:21:52Z INFO [AUDIT]     session.start addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2000I ei:0 event:session.start initial_command:[] login:ec2-user namespace:default private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25 time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23 user:teleport-admin user_kind:1 events/emitter.go:288","2024-05-28T14:21:56Z INFO [AUDIT]     session.leave cluster_name:teleport-plint code:T2003I ei:20 event:session.leave login:ec2-user namespace:default private_key_policy:none server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:22:01Z INFO [AUDIT]     session.end addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I ei:21 enhanced_recording:false event:session.end interactive:true login:ec2-user namespace:default participants:[teleport-admin] private_key_policy:none proto:ssh server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node session_start:2024-05-28T14:21:52.874611176Z session_stop:2024-05-28T14:22:01.60145508Z sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1 events/emitter.go:288\n","2024-05-28T14:21:56Z INFO [AUDIT]     session.data addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2006I ei:2.147483646e+09 event:session.data login:ec2-user namespace:default private_key_policy:none rx:5797 server_hostname:ip-172-29-245-165-ec2-internal server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.605Z tx:6264 uid:bc0b2d60-81e4-4a8f-a502-75c5e0978649 user:teleport-admin user_kind:1 events/emitter.go:288\n"],"grok":{"support_rules":"_log_prefix %{date(\"yyyy-MM-dd'T'HH:mm:ssZZ\"):date}\\s+%{word:log.level}\\s+\\[%{notSpace:teleport.service}\\]","match_rules":"parse_audit_user_login %{_log_prefix}\\s+user.login\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+method:%{notSpace:teleport.method}\\s+mfa_device_name:%{notSpace:teleport.mfa_device_name}\\s+mfa_device_type:%{notSpace:teleport.mfa_device_type}\\s+mfa_device_uuid:%{notSpace:teleport.mfa_device_uuid}\\s+required_private_key_policy:%{notSpace:teleport.required_private_key_policy}\\s+success:%{notSpace:teleport.success}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_agent:%{regex(\"[a-zA-Z/0-9. \n (;_),]+\"):teleport.user_agent}\\s%{notSpace}\n\nparse_audit_session_start %{_log_prefix}\\s+session.start\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+initial_command:%{notSpace:teleport.initial_command}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+sid:%{notSpace:teleport.sid}\\s+size:%{notSpace:teleport.size}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_leave %{_log_prefix}\\s+session.leave\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+event:%{notSpace:teleport.event}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+%{data::keyvalue(\":\",\"a-zA-Z-_.<>\")}\\s+%{notSpace:log.file}\n\nparse_audot_session_end %{_log_prefix}\\s+session.end\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name}\\s+code:%{notSpace:teleport.code}\\s+ei:%{notSpace:teleport.ei}\\s+enhanced_recording:%{notSpace:teleport.enhanced_recording}\\s+event:%{notSpace:teleport.event}\\s+interactive:%{notSpace:teleport.interactive}\\s+login:%{notSpace:teleport.login}\\s+namespace:%{notSpace:teleport.namespace}\\s+participants:%{notSpace:teleport.participants}\\s+private_key_policy:%{notSpace:teleport.private_key_policy}\\s+proto:%{notSpace:teleport.proto}\\s+server_addr:%{notSpace:teleport.server_addr}\\s+server_hostname:%{notSpace:teleport.server_hostname}\\s+server_id:%{notSpace:teleport.server_id}\\s+session_recording:%{notSpace:teleport.session_recording}\\s+session_start:%{notSpace:teleport.session_start}\\s+session_stop:%{notSpace:teleport.session_stop}\\s+sid:%{notSpace:teleport.sid}\\s+time:%{notSpace:teleport.time}\\s+uid:%{notSpace:teleport.uid}\\s+user:%{notSpace:teleport.user}\\s+user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n\nparse_audit_session_data %{_log_prefix}\\s+session.data\\s+(addr.local:%{ipOrHost:local.ip}:%{port:local.port}\\s+)?(addr.remote:%{ipOrHost:remote.ip}:%{port:remote.port})?\\s+cluster_name:%{notSpace:teleport.cluster_name} code:%{notSpace:teleport.code} ei:%{notSpace:teleport.ei} event:%{notSpace:teleport.event} login:%{notSpace:teleport.login} namespace:%{notSpace:teleport.namespace} private_key_policy:%{notSpace:teleport.private_key_policy} rx:%{notSpace:teleport.rx} server_hostname:%{notSpace:teleport.server_hostname} server_id:%{notSpace:teleport.server_id} sid:%{notSpace:teleport.sid} time:%{notSpace:teleport.time} tx:%{notSpace:teleport.tx} uid:%{notSpace:teleport.uid} user:%{notSpace:teleport.user} user_kind:%{notSpace:teleport.user_kind}\\s+%{notSpace:log.file}\n"},"type":"grok-parser"}],"tags":[],"description":"Logs Pipeline for the Teleport Integration"},{"id":"bwxMrzakQfyaPoHxy2Hgsw","type":"pipeline","name":"tf-TestAccDatadogLogsPipeline_basic-local-1738001536","is_enabled":true,"is_read_only":false,"filter":{"query":"source:redis"},"processors":[{"name":"Define date","is_enabled":true,"sources":["verbose"],"type":"date-remapper"},{"name":"processor from nested pipeline","is_enabled":true,"expression":"(time1-time2)*1000","target":"my_arithmetic","is_replace_missing":false,"type":"arithmetic-processor"},{"name":"Categorise severity level","is_enabled":true,"categories":[{"filter":{"query":"@severity: \"-\""},"name":"verbose"},{"filter":{"query":"@severity: \".\""},"name":"debug"}],"target":"redis.severity","type":"category-processor"},{"name":"Parsing Stack traces","is_enabled":true,"source":"message","samples":[],"grok":{"support_rules":"date_parser %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}","match_rules":"rule %{date(\"yyyy-MM-dd HH:mm:ss,SSS\"):timestamp}"},"type":"grok-parser"},{"type":"pipeline","name":"my nested pipeline","is_enabled":true,"filter":{"query":"source:kafka"},"processors":[{"name":"Define url parser","is_enabled":true,"sources":["http_test"],"target":"http_test.details","normalize_ending_slashes":false,"type":"url-parser"},{"name":"Define user agent parser","is_enabled":true,"sources":["http_agent"],"target":"http_agent.details","is_encoded":false,"type":"user-agent-parser"}]},{"name":"geo ip parse","is_enabled":true,"sources":["ip1"],"target":"ip.address","ip_processing_behavior":"do-nothing","type":"geo-ip-parser"},{"name":"","is_enabled":false,"source":"ip1","target":"ip.address","lookup_table":["key,value"],"type":"lookup-processor"},{"name":"lookup processor with optional fields","is_enabled":true,"source":"ip2","target":"ip.address","lookup_table":["key,value"],"default_lookup":"default","type":"lookup-processor"},{"name":"reftablelookup","is_enabled":true,"source":"sourcefield","target":"targetfield","lookup_enrichment_table":"test_reference_table_do_not_delete","type":"lookup-processor"}],"tags":["key1:value1","key2:value2"],"description":"Pipeline description"}]
        headers:
            Content-Type:
                - application/json
        status: 200 OK
        code: 200
        duration: 141.2905ms
